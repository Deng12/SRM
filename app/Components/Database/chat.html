<!--ws_client.html-->
<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> </head>
<h1>模拟Web Socket客户端·向服务端投递Task任务</h1>
<script>
  var reconn = false;
  function ws(){
    var wsUrl = "ws://39.99.165.81:9502";
    var webSocket = new WebSocket(wsUrl);

    //实例化JavaScript连接事件
    webSocket.onopen = function(evt){
      webSocket.send("我正在模拟向服务端发送消息");
      console.log("连接WebSocket成功！");
      reconn = false;
    }

    //实例化onmessage
    webSocket.onmessage = function(evt){
      console.log("服务端说：" + evt.data);
    }

    //实例化onclose事件
    webSocket.onclose = function(evt){
      console.log("Web Socket连接关闭");
      reconn = true;
    }

    //实例化onerror事件
    webSocket.onerror = function(evt,e){
      console.log("好像有些错误：" + evt.data);
    }
  }

  ws();

  setInterval(function(){
    if(reconn == true){
      ws();
    }
  }, 1000);


</script>
